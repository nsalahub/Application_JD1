DROP TABLE IF EXISTS `ORDER`;
DROP TABLE IF EXISTS ITEM;
DROP TABLE IF EXISTS PROFILE;
DROP TABLE IF EXISTS USERS;
DROP TABLE IF EXISTS ROLE_PERMISSION;
DROP TABLE IF EXISTS ROLE;
DROP TABLE IF EXISTS PERMISSION;
CREATE TABLE IF NOT EXISTS PERMISSION (ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,NAME ENUM ('CUSTOMER','SALES') NOT NULL);
CREATE TABLE IF NOT EXISTS ROLE (ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY, NAME VARCHAR (40) NOT NULL);
CREATE TABLE IF NOT EXISTS ROLE_PERMISSION (ROLE_ID BIGINT  NOT NULL,PERMISSION_ID BIGINT NOT NULL,PRIMARY KEY (ROLE_ID,PERMISSION_ID), FOREIGN KEY (ROLE_ID) REFERENCES ROLE(ID),FOREIGN KEY (PERMISSION_ID) REFERENCES PERMISSION(ID));
CREATE TABLE IF NOT EXISTS USERS (ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY, EMAIL VARCHAR (40),SURNAME VARCHAR (40),NAME VARCHAR (40) NOT NULL, PASSWORD VARCHAR (40) NOT NULL, ROLE_ID BIGINT NOT NULL, FOREIGN KEY (ROLE_ID) REFERENCES ROLE(ID),UNIQUE (EMAIL));
CREATE TABLE IF NOT EXISTS PROFILE (USER_ID BIGINT AUTO_INCREMENT NOT NULL, ADDRESS VARCHAR(63) NOT NULL,  TELEPHONE VARCHAR(31) NOT NULL,    FOREIGN KEY (USER_ID) REFERENCES USERS (ID),UNIQUE (USER_ID));
CREATE TABLE IF NOT EXISTS ITEM (ID BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY, NAME VARCHAR (40) NOT NULL, DESCRIPTION TEXT NOT NULL, UNIQUE_NUMBER VARCHAR (40) NOT NULL, PRICE DECIMAL NOT NULL, DELETED BOOLEAN DEFAULT FALSE NOT NULL);
CREATE TABLE IF NOT EXISTS `ORDER`(ID BIGINT NOT NULL AUTO_INCREMENT ,USER_ID BIGINT NOT NULL, ITEM_ID BIGINT NOT NULL, CREATED DATETIME NOT NULL, QUANTITY INT NOT NULL,STATE ENUM('NEW', 'REVIEWING', 'IN_PROGRESS', 'DELIVERED'),  PRIMARY KEY(ID),  FOREIGN KEY (USER_ID) REFERENCES USERS(ID),FOREIGN KEY (ITEM_ID) REFERENCES ITEM (ID));
INSERT INTO PERMISSION VALUES (1 ,'SALES');
INSERT INTO PERMISSION VALUES (2 ,'CUSTOMER');
INSERT INTO ROLE VALUES (1 ,'SALE');
INSERT INTO ROLE VALUES (2 ,'CUSTOMER');
INSERT INTO ROLE_PERMISSION VALUES (1,1);
INSERT INTO ROLE_PERMISSION VALUES (2,2);
INSERT INTO USERS VALUES (NULL ,'ADMIN','SALAHUB','NIKOLAY','123',1);
INSERT INTO PROFILE VALUES ((SELECT ID FROM USERS WHERE EMAIL = 'ADMIN'),'STADIONNAYA 7','+375295555555');